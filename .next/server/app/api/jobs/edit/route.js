(()=>{var e={};e.id=4989,e.ids=[4989],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},35630:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>l,serverHooks:()=>j,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{PATCH:()=>d,PUT:()=>p});var o=r(96559),a=r(48088),i=r(37719),n=r(32190),u=r(61223),c=r(44999);async function p(e){try{let t=(0,c.UL)(),r=(0,u.createRouteHandlerClient)({cookies:()=>t});console.log("✅ PUT route reached successfully");let{jobId:s,jobData:o,userId:a}=await e.json();if(console.log("\uD83D\uDCE6 Request data:",{jobId:s,userId:a,jobDataKeys:Object.keys(o)}),!s||!a)return n.NextResponse.json({error:"Missing jobId or userId"},{status:400});let{data:i,error:p}=await r.from("jobs").select("*").eq("id",s).eq("employer_id",a).single();if(p)return console.error("❌ Database fetch error:",p),n.NextResponse.json({error:"Database error: "+p.message},{status:500});if(!i)return n.NextResponse.json({error:"Job not found or access denied"},{status:404});let d={title:o.title,company:o.company,region:o.region,primary_industry:o.primaryIndustry,job_type:o.jobType,hourly_rate:o.hourlyRate,description:o.description,contact_email:o.contactEmail,updated_at:new Date().toISOString()};if(o.status&&(d.status=o.status,"active"===o.status)){let e=new Date;e.setDate(e.getDate()+30),d.expiry_date=e.toISOString()}console.log("\uD83D\uDCDD Updating job with simplified data:",d);let{data:l,error:x}=await r.from("jobs").update(d).eq("id",s).eq("employer_id",a).select().single();if(x)return console.error("❌ Database update error:",x),n.NextResponse.json({error:"Failed to update job: "+x.message},{status:500});return console.log("✅ Job updated successfully:",l.id),n.NextResponse.json({success:!0,message:"Job updated successfully",job:l})}catch(e){return console.error("❌ API Error:",e),n.NextResponse.json({error:"Internal server error: "+e.message},{status:500})}}async function d(e){try{let t=(0,c.UL)(),r=(0,u.createRouteHandlerClient)({cookies:()=>t});console.log("✅ PATCH route reached successfully");let{jobId:s,status:o,userId:a}=await e.json();console.log("\uD83D\uDCE6 Status update data:",{jobId:s,status:o,userId:a});let{data:i,error:p}=await r.from("jobs").select("*").eq("id",s).eq("employer_id",a).single();if(p||!i)return n.NextResponse.json({error:"Job not found or access denied"},{status:404});let d={status:o,updated_at:new Date().toISOString()};if("active"===o){let e=new Date;e.setDate(e.getDate()+30),d.expiry_date=e.toISOString()}else"expired"===o&&(d.expiry_date=new Date().toISOString());let{data:l,error:x}=await r.from("jobs").update(d).eq("id",s).eq("employer_id",a).select().single();if(x)return console.error("❌ Database error:",x),n.NextResponse.json({error:"Failed to update job status: "+x.message},{status:500});return console.log("✅ Job status updated successfully"),n.NextResponse.json({success:!0,message:`Job ${"active"===o?"activated":"paused"===o?"paused":"expired"} successfully`,job:l})}catch(e){return console.error("❌ API Error:",e),n.NextResponse.json({error:"Internal server error: "+e.message},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/jobs/edit/route",pathname:"/api/jobs/edit",filename:"route",bundlePath:"app/api/jobs/edit/route"},resolvedPagePath:"/Users/mattiebrooke/fieldjobs-website/app/api/jobs/edit/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:g,serverHooks:j}=l;function y(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:g})}},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,131,2190],()=>r(35630));module.exports=s})();