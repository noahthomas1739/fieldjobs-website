(()=>{var e={};e.id=3216,e.ids=[3216],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},20563:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>m,routeModule:()=>l,serverHooks:()=>v,workAsyncStorage:()=>j,workUnitAsyncStorage:()=>b});var t={};s.r(t),s.d(t,{DELETE:()=>d,GET:()=>c,POST:()=>p});var o=s(96559),n=s(48088),a=s(37719),i=s(61223),u=s(44999);async function c(e){try{let r=(0,u.UL)(),s=(0,i.createRouteHandlerClient)({cookies:()=>r}),{searchParams:t}=new URL(e.url),o=t.get("userId");if(!o)return Response.json({error:"User ID required"},{status:400});let{data:n,error:a}=await s.from("saved_jobs").select(`
        *,
        jobs (
          id,
          title,
          company,
          region,
          hourly_rate,
          job_type,
          primary_industry,
          created_at
        )
      `).eq("user_id",o).order("created_at",{ascending:!1});if(a)return console.error("Database error:",a),Response.json({error:"Database error: "+a.message},{status:500});return Response.json({savedJobs:n})}catch(e){return console.error("Server error:",e),Response.json({error:"Internal server error"},{status:500})}}async function p(e){try{let r=(0,u.UL)(),s=(0,i.createRouteHandlerClient)({cookies:()=>r}),{userId:t,jobId:o,jobData:n}=await e.json();if(!t||!o)return Response.json({error:"User ID and Job ID required"},{status:400});let{data:a,error:c}=await s.from("jobs").select("id").eq("id",o).single();if(c&&"PGRST116"===c.code){let{data:e,error:r}=await s.from("jobs").insert([{id:o,title:n.title,company:n.company,region:n.region,hourly_rate:n.hourlyRate,job_type:n.jobType,primary_industry:n.primaryIndustry||n.type,description:n.description,contact_email:n.contactEmail||"contact@company.com",status:"active"}]).select().single();if(r)return console.error("Error creating job:",r),Response.json({error:"Error creating job: "+r.message},{status:500})}let{data:p,error:d}=await s.from("saved_jobs").insert([{user_id:t,job_id:o}]).select().single();if(d){if("23505"===d.code)return Response.json({error:"Job already saved"},{status:409});return console.error("Error saving job:",d),Response.json({error:"Error saving job: "+d.message},{status:500})}return Response.json({success:!0,savedJob:p})}catch(e){return console.error("Server error:",e),Response.json({error:"Internal server error"},{status:500})}}async function d(e){try{let r=(0,u.UL)(),s=(0,i.createRouteHandlerClient)({cookies:()=>r}),{searchParams:t}=new URL(e.url),o=t.get("userId"),n=t.get("jobId");if(!o||!n)return Response.json({error:"User ID and Job ID required"},{status:400});let{error:a}=await s.from("saved_jobs").delete().eq("user_id",o).eq("job_id",n);if(a)return console.error("Error removing saved job:",a),Response.json({error:"Error removing saved job: "+a.message},{status:500});return Response.json({success:!0})}catch(e){return console.error("Server error:",e),Response.json({error:"Internal server error"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/saved-jobs/route",pathname:"/api/saved-jobs",filename:"route",bundlePath:"app/api/saved-jobs/route"},resolvedPagePath:"/Users/mattiebrooke/fieldjobs-website/app/api/saved-jobs/route.js",nextConfigOutput:"",userland:t}),{workAsyncStorage:j,workUnitAsyncStorage:b,serverHooks:v}=l;function m(){return(0,a.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:b})}},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,131],()=>s(20563));module.exports=t})();