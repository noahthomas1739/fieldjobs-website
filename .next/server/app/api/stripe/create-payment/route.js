(()=>{var e={};e.id=5465,e.ids=[5465],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},77900:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>k,routeModule:()=>g,serverHooks:()=>R,workAsyncStorage:()=>b,workUnitAsyncStorage:()=>P});var s,n={};t.r(n),t.d(n,{POST:()=>S});var o=t(96559),i=t(48088),a=t(37719),u=t(32190),c="basil",p="https://js.stripe.com",l="".concat(p,"/").concat(c,"/stripe.js"),d=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,m=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,v=function(){for(var e=document.querySelectorAll('script[src^="'.concat(p,'"]')),r=0;r<e.length;r++){var t,s=e[r];if(t=s.src,d.test(t)||m.test(t))return s}return null},x=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",t=document.createElement("script");t.src="".concat(l).concat(r);var s=document.head||document.body;if(!s)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(t),t},h=function(e,r){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"7.4.0",startTime:r})},f=null,y=null,_=null,w=function(){return s?s:s=(null!==f?f:(f=new Promise(function(e,r){if("undefined"==typeof window||"undefined"==typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var t,s=v();s?s&&null!==_&&null!==y&&(s.removeEventListener("load",_),s.removeEventListener("error",y),null==(t=s.parentNode)||t.removeChild(s),s=x(null)):s=x(null),_=function(){window.Stripe?e(window.Stripe):r(Error("Stripe.js not available"))},y=function(e){r(Error("Failed to load Stripe.js",{cause:e}))},s.addEventListener("load",_),s.addEventListener("error",y)}catch(e){r(e);return}})).catch(function(e){return f=null,Promise.reject(e)})).catch(function(e){return s=null,Promise.reject(e)})};Promise.resolve().then(function(){return w()}).catch(function(e){console.warn(e)});let j=new(t(97877)).A(process.env.STRIPE_SECRET_KEY||"sk_test_placeholder",{apiVersion:"2023-10-16"});var E=t(61223),q=t(44999);async function S(e){try{let{jobData:r}=await e.json(),t=(0,E.createRouteHandlerClient)({cookies:q.UL}),{data:{user:s},error:n}=await t.auth.getUser();if(n||!s)return u.NextResponse.json({error:"Unauthorized"},{status:401});let o=await j.checkout.sessions.create({payment_method_types:["card"],line_items:[{price:process.env.STRIPE_SINGLE_JOB_PRICE_ID,quantity:1}],mode:"payment",success_url:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000"}/employer?payment_success=true`,cancel_url:`${process.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000"}/employer?payment_canceled=true`,metadata:{user_id:s.id,job_title:r.title,payment_type:"single_job"}});return u.NextResponse.json({sessionId:o.id,jobData:r})}catch(e){return console.error("Error creating payment:",e),u.NextResponse.json({error:"Internal Server Error"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/stripe/create-payment/route",pathname:"/api/stripe/create-payment",filename:"route",bundlePath:"app/api/stripe/create-payment/route"},resolvedPagePath:"/Users/mattiebrooke/fieldjobs-website/app/api/stripe/create-payment/route.js",nextConfigOutput:"",userland:n}),{workAsyncStorage:b,workUnitAsyncStorage:P,serverHooks:R}=g;function k(){return(0,a.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:P})}},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,131,2190,7877],()=>t(77900));module.exports=s})();